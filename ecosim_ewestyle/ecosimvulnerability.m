function v = ecosimvulnerability(kv, q0, b);
%ECOSIMVULNERABILITY Calculates vulnerability exchange rate
%
% v = ecosimvulnerability(kv, q0, b);
%
% Calculates the vulnerablity exchange rate for each predator-prey
% interaction, based on the formula vi = kij*Qij/Bi (in notes, but
% where did I get this from?).
%
% Input variables:
%
%   kv: ngroup x ngroup array, prey x pred, constant defining the ratio of
%       this exchange rate to the loss rate due to predation (or something
%       like that) 
%
%   q0: ngroup x ngroup array, prey x pred, consumption of each prey by
%       each predator at mass balance (concentration/time)
%
%   b:  ngroup x 1 array, biomass of each group at mass balance
%       (concentration)
%
% Output variables:
%
%   v:  ngroup x ngroup array, prey x pred, exchange rate between
%       vulnerable and invulnerable prey populations for each predator-prey
%       interaction (1/time).

% Copyright 2008 Kelly Kearney

ng = length(b);
if ~isvector(b)
    error('b must be vector');
end
b = b(:);

if ~isequal([ng ng], size(kv), size(q0))
    error('kv and q0 must be square matrices the same length as b');
end

v = bsxfun(@rdivide, kv .* q0, b);


